﻿<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="robots" content="index, follow" />
	<meta name="keywords" content="" />
	<meta name="description" content="windows自动化安装系统装好用用c:windowssystem32sysrepsysprep.exe封装.把 WMPNetworkSvc&nbsp; &nbsp;(Windows Media Player Netwroking SharingService)服务停用 试试！&nbsp;然后编写命令行代码自动安装驱动.&nb..." />
	<meta name="Copyright" content="Copyright (c) 2015" />
	<meta name="author" content="财务狗--Powered by yourphp">
	<meta name="generator" content="Yourphp 2.0" />
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
	<title>自动化运维系列-自动化安装windows7-博客-财务狗</title>
	<link href="/index.php?m=Format&a=rss" rel="alternate" type="application/rss+xml" title="RSS 2.0" />
	<script src="/Public/Js/jquery.min.js"></script>
	<script src="/Public/Js/responsiveslides.min.js"></script>
	<script src="/Public/Js/slide.js"></script>
	<link rel="stylesheet" type="text/css" href="/Yourphp/Tpl/Home/Default/Public/css/style.css" /> 
	<link rel="stylesheet" type="text/css" href="/Yourphp/Tpl/Home/Default/Public/css/lrtk.css" /> 
</head>
<body>
<div class="head_b">
	<div class="main">
		<div class="head_r">

        	<div class="head_s">
           	  <ul class="head_s_i"><input name="" id="key" onkeydown="SearchNew2(event)" type="text" /></ul>
              <input class="head_s_b" onclick="Search()" type="button" style="border:none;"/>
            </div>
        </div>
    <div class="nav1">
            <div class="logo"><a href="index.html"><img src="/Yourphp/Tpl/Home/Default/Public/images/logo.png"/></a></div>
            <div class="nav_b">
		<div id="nav" class="nav">
		<ul id="nav_box"><li id="nav_0"><span class="fl_ico"></span><a href="/" title="网站首页"><span class="fl">网站首页</span></a></li><li id="nav_33" class="first file"><span class="fl_ico"></span><a href="/list-33.html" title="关于我们"><span class="fl">关于我们</span></a></li><li id="nav_35" class="foot file"><span class="fl_ico"></span><a href="/news/" title="博客"><span class="fl">博客</span></a></li></ul>
		</div>
      </div>
	</div>
    </div>
 
</div>
<script type="text/javascript">
var APP	 =	 '';
var ROOT =	 '';
var PUBLIC = '/Public';
yourphpnav.init({navid: "nav"});
var nav = document.getElementById('nav_32');nav.className=nav.className+" on";
</script>
<div class="warp"><div id="main">
<div class="c"></div>

<div class="ny_banner3"></div>
	<div class="banner_bjt"></div>
<div class="mains">
		<div class="ny_widht clearfix">
		
<div class="ny_right right">
	<div class="title_wz"><b></b><span>当前位置： <a href="/">网站首页</a> &gt <a href="/list-32.html">时代旅行社</a> &gt; <a href="/news/">博客</a></span></div>
	<div class="about">
	<h1>自动化运维系列-自动化安装windows7</h1> 
    <h3>时间: 2016-03-15 23:21:15 &nbsp;&nbsp;&nbsp;&nbsp;来源: 财务狗</h3>
    <span class="content"><p class="p1">
	<br />
</p>
<p class="p2">
	<span class="s1"></span>
</p>
<p class="p1">
	<br />
</p>
<p class="p2">
	<span class="s1"></span>
</p>
<p class="p1">
	<span class="s1">windows自动化安装</span>
</p>
<p class="p1">
	<span class="s1">系统装好用用c:\windows\system32\sysrep\sysprep.exe封装.</span>
</p>
<p class="p4">
	<span class="s1">把 WMPNetworkSvc&nbsp; &nbsp;(Windows Media Player Netwroking SharingService)服务停用 试试！</span>
</p>
<p class="p5">
	<span class="s1"></span>
</p>
<p class="p1">
	<span class="s1">&nbsp;然后编写命令行代码自动安装驱动.</span>
</p>
<p class="p6">
	<span class="s4">&nbsp;c:\windows\system32\sysprep\</span><span class="s1">Sysprep /generalize /oobe /reboot /unattend:unattend.xml</span>
</p>
<p class="p7">
	<span class="s1"></span>
</p>
<p class="p6">
	<span class="s1">unattend.xml&nbsp;</span>
</p>
<p class="p6">
	<span class="s1">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
</p>
<p class="p6">
	<span class="s1">&lt;!--This answer file generated by RT Seven Lite--&gt;</span>
</p>
<p class="p6">
	<span class="s1">&lt;unattend xmlns="urn:schemas-microsoft-com:unattend"&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &lt;settings pass="windowsPE"&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &lt;component name="Microsoft-Windows-International-Core-WinPE" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="NonSxS" xmlns:wcm="<a href="http://schemas.microsoft.com/WMIConfig/2002/State"><span class="s5">http://schemas.microsoft.com/WMIConfig/2002/State</span></a>" xmlns:xsi="<a href="http://www.w3.org/2001/XMLSchema-instance"><span class="s5">http://www.w3.org/2001/XMLSchema-instance</span></a>"&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;SetupUILanguage&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;UILanguage&gt;zh-CN&lt;/UILanguage&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;/SetupUILanguage&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;InputLocale&gt;0804:00000804&lt;/InputLocale&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;UserLocale&gt;zh-CN&lt;/UserLocale&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;UILanguage&gt;zh-CN&lt;/UILanguage&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;SystemLocale&gt;zh-CN&lt;/SystemLocale&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &lt;/component&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &lt;component name="Microsoft-Windows-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="NonSxS" xmlns:wcm="<a href="http://schemas.microsoft.com/WMIConfig/2002/State"><span class="s5">http://schemas.microsoft.com/WMIConfig/2002/State</span></a>" xmlns:xsi="<a href="http://www.w3.org/2001/XMLSchema-instance"><span class="s5">http://www.w3.org/2001/XMLSchema-instance</span></a>"&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;ImageInstall&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;OSImage&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;InstallFrom&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;MetaData wcm:action="add"&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Key&gt;/IMAGE/NAME&lt;/Key&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;value&gt;Windows 7 PROFESSIONAL&lt;/value&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/MetaData&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/InstallFrom&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;InstallToAvailablePartition&gt;false&lt;/InstallToAvailablePartition&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;WillShowUI&gt;OnError&lt;/WillShowUI&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/OSImage&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;/ImageInstall&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;UserData&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;ProductKey&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Key&gt;HYF8J-CVRMY-CM74G-RPHKF-PW487&lt;/Key&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;WillShowUI&gt;OnError&lt;/WillShowUI&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/ProductKey&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;Organization&gt;WORKGROUP&lt;/Organization&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;FullName&gt;Administrator&lt;/FullName&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;AcceptEula&gt;true&lt;/AcceptEula&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;/UserData&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &lt;/component&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &lt;/settings&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &lt;settings pass="oobeSystem"&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &lt;component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="NonSxS" xmlns:wcm="<a href="http://schemas.microsoft.com/WMIConfig/2002/State"><span class="s5">http://schemas.microsoft.com/WMIConfig/2002/State</span></a>" xmlns:xsi="<a href="http://www.w3.org/2001/XMLSchema-instance"><span class="s5">http://www.w3.org/2001/XMLSchema-instance</span></a>"&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;UserAccounts&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;LocalAccounts /&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;AdministratorPassword&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Value /&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/AdministratorPassword&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;/UserAccounts&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;AutoLogon&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;Password&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Value /&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/Password&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;Enabled&gt;true&lt;/Enabled&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;LogonCount&gt;1&lt;/LogonCount&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;Username&gt;Administrator&lt;/Username&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;/AutoLogon&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;OOBE&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;NetworkLocation&gt;Other&lt;/NetworkLocation&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;HideEULAPage&gt;true&lt;/HideEULAPage&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;ProtectYourPC&gt;3&lt;/ProtectYourPC&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;HideWirelessSetupInOOBE&gt;true&lt;/HideWirelessSetupInOOBE&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;SkipMachineOOBE&gt;true&lt;/SkipMachineOOBE&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;SkipUserOOBE&gt;true&lt;/SkipUserOOBE&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;/OOBE&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;DisableAutoDaylightTimeSet&gt;false&lt;/DisableAutoDaylightTimeSet&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;TimeZone&gt;China Standard Time&lt;/TimeZone&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;Display&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;ColorDepth&gt;32&lt;/ColorDepth&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;HorizontalResolution&gt;1024&lt;/HorizontalResolution&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;VerticalResolution&gt;768&lt;/VerticalResolution&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;RefreshRate&gt;60&lt;/RefreshRate&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;/Display&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &lt;/component&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &lt;/settings&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &lt;settings pass="specialize"&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &lt;component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="NonSxS" xmlns:wcm="<a href="http://schemas.microsoft.com/WMIConfig/2002/State"><span class="s5">http://schemas.microsoft.com/WMIConfig/2002/State</span></a>" xmlns:xsi="<a href="http://www.w3.org/2001/XMLSchema-instance"><span class="s5">http://www.w3.org/2001/XMLSchema-instance</span></a>"&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;ComputerName&gt;admin&lt;/ComputerName&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &lt;/component&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &lt;component name="Microsoft-Windows-Security-Licensing-SLC-UX" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="NonSxS" xmlns:wcm="<a href="http://schemas.microsoft.com/WMIConfig/2002/State"><span class="s5">http://schemas.microsoft.com/WMIConfig/2002/State</span></a>" xmlns:xsi="<a href="http://www.w3.org/2001/XMLSchema-instance"><span class="s5">http://www.w3.org/2001/XMLSchema-instance</span></a>"&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &nbsp; &lt;SkipAutoActivation&gt;true&lt;/SkipAutoActivation&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &nbsp; &lt;/component&gt;</span>
</p>
<p class="p6">
	<span class="s1">&nbsp; &lt;/settings&gt;</span>
</p>
<p class="p6">
	<span class="s1">&lt;/unattend&gt;</span>
</p>
<p class="p2">
	<span class="s1"></span>
</p>
<p class="p1">
	<span class="s1">第一安装好一台机器</span>
</p>
<p class="p1">
	<span class="s1">然后用预封装的形式打包</span>
</p>
<p class="p1">
	<span class="s1">加入驱动精灵的驱动人生的离线驱动包</span>
</p>
<p class="p1">
	<span class="s1">用自己删除的脚本放入启动文件夹.</span>
</p>
<p class="p1">
	<span class="s1">1.run.au3</span>
</p>
<p class="p1">
	<span class="s1">&nbsp;#RequireAdmin</span>
</p>
<p class="p1">
	<span class="s1">Run("c:\dtl_cdrom.exe")</span>
</p>
<p class="p1">
	<span class="s1">;Sleep(1000)</span>
</p>
<p class="p1">
	<span class="s1">MouseClick("left",770,110)</span>
</p>
<p class="p2">
	<span class="s1"></span>
</p>
<p class="p1">
	<span class="s1">2.run.bat</span>
</p>
<p class="p1">
	<span class="s1">@echo off</span>
</p>
<p class="p1">
	<span class="s1">c:\run.exe</span>
</p>
<p class="p1">
	<span class="s1">del "%~f0"&nbsp;</span>
</p>
<p class="p1">
	<span class="s1">run.exe放系统根目录</span>
</p>
<p class="p1">
	<span class="s1">run.bat放入公共用户启动文件夹</span>
</p>
<p class="p1">
	<span class="s1">安装后.整个系统就好了.驱动会自动安装.如果还需要做其他处理.也可以用run.bat做一次化处理.</span>
</p>
<p class="p1">
	<span class="s1">&nbsp;</span>
</p>
<p class="p2">
	<span class="s1"></span>
</p></span>           
	
	<div id="pages" class="page"></div>
		</div>
</div> 
<script language="JavaScript" src="/index.php?m=Article&a=hits&id=20"></script>
		<div class="ny_left left">
				<h1><a href="about.html"><img src="/Yourphp/Tpl/Home/Default/Public/images/title1.gif" alt="关于東井" /></a></h1>
				<div class="ny_nav">
				<ul>

		    <li><a href="/list-33.html">关于我们</a></li>
		<li><a href="/news/">博客</a></li>
						</ul>
				</div>
				<div class="latest_news">
				<h2><span class="left">最新动态</span><span class="right"><a href="new.html">+</a></span></h2>

		<ul>
		<a href="/news/show/53.html" target="_blank">iOS 自动化测试代码</a><p><a href="/news/show/52.html" target="_blank">自动化测试--htmlunit无界面测试</a><p><a href="/news/show/51.html" target="_blank">linux 下的配置管理命令</a><p><a href="/news/show/50.html" target="_blank">logical查看 system.out.print</a><p><a href="/news/show/49.html" target="_blank">android实现监听短信的代码</a><p><a href="/news/show/48.html" target="_blank">shell 并行执行脚本</a><p><a href="/news/show/47.html" target="_blank">vim 编辑 替换</a><p><a href="/news/show/46.html" target="_blank">windows7 x86自动安装应答文件</a><p><a href="/news/show/45.html" target="_blank">win7 64位自动装机应答文件Autounatte...</a><p><a href="/news/show/44.html" target="_blank">win7 文件共享</a><p> 
		</ul>

				</div>
				<div class="contact_img"><a href="contact.html"><img src="/Yourphp/Tpl/Home/Default/Public/images/contact_img.jpg"></a></div>
			</div>
 
</div>
</div>
<div class="c"></div>
<br>

</div></div>

<div class="footer">
	<div class="main">
        <div class="footer_k1" style="color:#fff;">Copyleft ,复制请说明出处 </div>
    </div>
</div>

<script>showon('.catlist ul li.folder','span.fd_ico','35');</script>
</body>
</html>