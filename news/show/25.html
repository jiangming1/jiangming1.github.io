﻿<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="robots" content="index, follow" />
	<meta name="keywords" content="" />
	<meta name="description" content="小孙所在单位的网络是通过ISA连接到Internet的，在ISA服务器上安装了DHCP服务，为所属的客户端计算机分配IP地址。网络中大部分计算机都是笔记本电脑，移动性比较强，如果笔记本电脑使用固定IP，就会带来很多麻烦——..." />
	<meta name="Copyright" content="Copyright (c) 2015" />
	<meta name="author" content="财务狗--Powered by yourphp">
	<meta name="generator" content="Yourphp 2.0" />
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
	<title>autoit windows的自动化处理工具-博客-财务狗</title>
	<link href="/index.php?m=Format&a=rss" rel="alternate" type="application/rss+xml" title="RSS 2.0" />
	<script src="/Public/Js/jquery.min.js"></script>
	<script src="/Public/Js/responsiveslides.min.js"></script>
	<script src="/Public/Js/slide.js"></script>
	<link rel="stylesheet" type="text/css" href="/Yourphp/Tpl/Home/Default/Public/css/style.css" /> 
	<link rel="stylesheet" type="text/css" href="/Yourphp/Tpl/Home/Default/Public/css/lrtk.css" /> 
</head>
<body>
<div class="head_b">
	<div class="main">
		<div class="head_r">

        	<div class="head_s">
           	  <ul class="head_s_i"><input name="" id="key" onkeydown="SearchNew2(event)" type="text" /></ul>
              <input class="head_s_b" onclick="Search()" type="button" style="border:none;"/>
            </div>
        </div>
    <div class="nav1">
            <div class="logo"><a href="index.html"><img src="/Yourphp/Tpl/Home/Default/Public/images/logo.png"/></a></div>
            <div class="nav_b">
		<div id="nav" class="nav">
		<ul id="nav_box"><li id="nav_0"><span class="fl_ico"></span><a href="/" title="网站首页"><span class="fl">网站首页</span></a></li><li id="nav_33" class="first file"><span class="fl_ico"></span><a href="/list-33.html" title="关于我们"><span class="fl">关于我们</span></a></li><li id="nav_35" class="foot file"><span class="fl_ico"></span><a href="/news/" title="博客"><span class="fl">博客</span></a></li></ul>
		</div>
      </div>
	</div>
    </div>
 
</div>
<script type="text/javascript">
var APP	 =	 '';
var ROOT =	 '';
var PUBLIC = '/Public';
yourphpnav.init({navid: "nav"});
var nav = document.getElementById('nav_32');nav.className=nav.className+" on";
</script>
<div class="warp"><div id="main">
<div class="c"></div>

<div class="ny_banner3"></div>
	<div class="banner_bjt"></div>
<div class="mains">
		<div class="ny_widht clearfix">
		
<div class="ny_right right">
	<div class="title_wz"><b></b><span>当前位置： <a href="/">网站首页</a> &gt <a href="/list-32.html">时代旅行社</a> &gt; <a href="/news/">博客</a></span></div>
	<div class="about">
	<h1>autoit windows的自动化处理工具</h1> 
    <h3>时间: 2016-03-17 11:10:35 &nbsp;&nbsp;&nbsp;&nbsp;来源: 财务狗</h3>
    <span class="content">小孙所在单位的网络是通过ISA连接到Internet的，在ISA服务器上安装了DHCP服务，为所属的客户端计算机分配IP地址。网络中大部分计算机都是笔记本电脑，移动性比较强，如果笔记本电脑使用固定IP，就会带来很多麻烦——笔记本电脑的使用者每移动到一个新的网络环境中，就需要手动改变网络参数。还有网络中有一些特殊的IP地址是需要分配给特定的计算机的，这样即方便管理也可以防止病毒的攻击。<br />
<br />
<br />
批处理重复性工作<br />
<br />
<br />
其实小孙遇到的问题可以通过使用AutoIT编写一个脚本来解决。AutoIT是一款具有自动化功能的控制软件，它可以根据事先编写好的脚本完成事先指定的工作。AutoIT虽然是一种脚本控制程序，也需要编程，但AutoIT的脚本比Windows脚本要简单得多——它不需要记忆众多的参数，也不需要学习复杂的语法。值得一提的是，AutoIT的应用目标非常明确：凡是在计算机上可以由人工手动完成的一些固定的操作，尤其是经常重复的一些操作，都可以通过编写AutoIT脚本自动来完成。<br />
<br />
<br />
AutoIt是一款免费软件，它可以用来编写具有BASIC语言风格的脚本程序，它被设计用来在Windows GUI（Windows图形界面）中进行自动化操作。通过AutoIT可以模拟键盘按键动作（例如，按下某个键、同时按下某几个键、按下某个键几次）、鼠标移动、鼠标按键和Windows 窗口或控件操作等以实现自动化操作。这是其他语言所无法做到，或者说尚无可靠的方法来实现的。<br />
<br />
<br />
AutoIt最早是为台式机进行自动批处理而设计的，用来对数千台计算机进行同样的配置，不过随着v3版本的到来，它已经很适合用于家庭自动化和编写，用以完成重复性任务的脚本。<br />
<br />
<br />
AutoIt 可以执行以下几个功能：<br />
<br />
<br />
·执行Windows及DOS下的可执行文件；<br />
<br />
<br />
· 模拟击键动作（支持大多数键盘布局）；<br />
<br />
<br />
· 模拟鼠标移动和单击动作；<br />
<br />
<br />
·对窗口进行移动、调整大小等操作；<br />
<br />
<br />
·直接与窗口的控件交互，如设置或获取文字、移动、关闭窗口等；<br />
<br />
<br />
· 配合剪贴板进行剪切的、粘贴文本操作；<br />
<br />
<br />
·对注册表进行操作。<br />
<br />
<br />
AutoIT最新版本已经达到3.2。用户可以从其网方网站下载最新的版本，也可以从AutoIT中文论坛下载其汉化版本。<br />
<br />
<br />
AutoIt运行时读取一个指定的脚本文件。这个脚本文件使得AutoIt完成一系列操作，包括：<br />
<br />
<br />
·执行Windows应用程序、DOS命令等；<br />
<br />
<br />
·发送键盘和鼠标操作；<br />
<br />
<br />
·窗口操作，如最小化、隐藏、恢复、等待、激活等；<br />
<br />
<br />
·剪贴板操作。<br />
<br />
<br />
AutoIt是一款共享软件，在使用上没有任何限制。AutoIT按照人们事先制定的脚本来实现相应的功能，这类似于DOS中的批处理、Word中的宏。许多情况下都可以通过AutoIT来提高IT效率。<br />
<br />
<br />
比如说，人们上班后的第一件事就是打开IE浏览器，登录邮箱检查新的邮件。登录邮箱时，需要输入邮件服务器地址、用户及密码等信息，这些都可以通过AutoIT来完成。<br />
<br />
<br />
再比如说，在软件的安装过程中有些软件需要接受许可协议、输入产品安装序列号，安装完成后还需要打上最新的补丁，以及做一些必要的配置等操作也可以通过AutoIT来完成。<br />
<br />
<br />
对于网络管理员来说，每次安装完操作系统后，都需要进行一些重复的操作。比如说，当Windows Server 2003安装完成后，由于其安全性问题，在每次开机时都会弹出“管理您的服务器”页面，需要打开组策略，选择“禁用”这一项也可以通过AutoIT来完成。<br />
<br />
<br />
以上三种情况的操作都可以制作相应的脚本，并且把脚本编译成可执行程序，运行编辑后的可执行程序，而且还可以在其他类似的计算机上进行相应的操作。<br />
<br />
<br />
四步完成一组操作<br />
<br />
<br />
因此，小孙遇到的问题也可以通过编写一个AutoIt脚本来完成。这个脚本的编写思路主要如下：<br />
<br />
<br />
第一步：获取ＭＡＣ地址与ＩＰ地址对照表<br />
<br />
<br />
登录网络中心的三层交换机（本文以华为的3526为例进行说明），使用display arp命令获取网络中的MAC地址表。然后将MAC地址表粘贴到Word文档中，使用查找/替换功能替换掉MAC地址中间的“-”，将IP地址与MAC地址中间的空格替换为回车，然后将 MAC地址粘贴到地址对照表mac-addr.txt文件中。地址对照表mac-addr.txt的内容如下：<br />
<br />
<br />
172.20.1.1<br />
<br />
<br />
00e04c4616a5<br />
<br />
<br />
172.20.1.<br />
<br />
<br />
16c2defac<br />
<br />
<br />
172.20.1.99<br />
<br />
<br />
20c77209f<br />
<br />
<br />
172.20.1.211<br />
<br />
<br />
20c7720c7<br />
<br />
<br />
172.20.1.215<br />
<br />
<br />
20c7720a2<br />
<br />
<br />
第二步：编写脚本配置文件<br />
<br />
<br />
新建一个脚本配置文件mac.txt，用来保存脚本的配置信息。<br />
<br />
<br />
配置文件max.txt中输入如下内容：<br />
<br />
<br />
输入前面作用域已经创建的保留个数<br />
<br />
<br />
5<br />
<br />
<br />
输入在第几个作用域新建保留<br />
<br />
<br />
2<br />
<br />
<br />
输入新建保留名称的前一部分<br />
<br />
<br />
no.<br />
<br />
<br />
输入新建保留描述信息的前一部分<br />
<br />
<br />
this is no.<br />
<br />
<br />
输入新建保留的个数<br />
<br />
<br />
5<br />
<br />
<br />
这个配置文件中保存着自动绑定MAC地址AutotIT脚本的一些配置信息。<br />
<br />
<br />
第三步：编写脚本<br />
<br />
<br />
下面就可以开始编写自动绑定MAC地址的AutoIT脚本了。新建一个max-auto.au3文件，通过同时按下WIN+R键打开“运行”对话框，在此打开AuotIT的窗口信息工具捕获此页的信息，以便做出正解的响应。<br />
<br />
<br />
在“运行”对话框中输入：“%SystemRoot%\system32\dhcpmgmt.msc /s”命令，按下回车键打开“DHCP”配置窗口。<br />
<br />
<br />
这几步操作的AutoIT代码如下：<br />
<br />
<br />
Send("#r")；<br />
<br />
<br />
打开“运行”对话框<br />
<br />
<br />
WinWaitActive(“运行","")<br />
<br />
<br />
inActive("运行","")<br />
<br />
<br />
sleep(1)<br />
<br />
<br />
Send("%SystemRoot%\system32\dhcpmgmt.msc /s")<br />
<br />
<br />
在“运行”对话框中输入 %SystemRoot%\system32\dhcpmgmt.msc /s命令<br />
<br />
<br />
Send("{enter}")<br />
<br />
<br />
下面脚本编写过程与此过程相似，每当打开一个新的窗口时，都需要使用AutoIt的窗口信息工具捕获此页的信息，以便做出正确的响应。<br />
<br />
<br />
然后，使用send("")命令发送键盘操作及输入相应的命令行。<br />
<br />
<br />
第四步：编译脚本<br />
<br />
<br />
此时编写的脚本必须要在AutoIT环境中运行。<br />
<br />
<br />
如果要想让编写的脚本脱离AutoIT环境使用，可以通过右键单击文件max-auto.au3在弹出的快捷菜单中选择“Compile Script”命令编译脚本，AutoIT编译程序将该脚本编译成exe文件，如图2所示。经过编译后的脚本，就可以脱离AutoIT环境独立运行了。<br />
<br />
<br />
小孙使用这个AutoIT脚本，重新安装完DHCP服务后，在很短的时间内就完成了MAC地址的绑定。在问题得到解决后，小孙打来电话兴奋地对我说：“AutoIT脚本可真算得上是网络管理员的一个好帮手啊！”。<br /></span>           
	
	<div id="pages" class="page"></div>
		</div>
</div> 
<script language="JavaScript" src="/index.php?m=Article&a=hits&id=25"></script>
		<div class="ny_left left">
				<h1><a href="about.html"><img src="/Yourphp/Tpl/Home/Default/Public/images/title1.gif" alt="关于東井" /></a></h1>
				<div class="ny_nav">
				<ul>

		    <li><a href="/list-33.html">关于我们</a></li>
		<li><a href="/news/">博客</a></li>
						</ul>
				</div>
				<div class="latest_news">
				<h2><span class="left">最新动态</span><span class="right"><a href="new.html">+</a></span></h2>

		<ul>
		<a href="/news/show/53.html" target="_blank">iOS 自动化测试代码</a><p><a href="/news/show/52.html" target="_blank">自动化测试--htmlunit无界面测试</a><p><a href="/news/show/51.html" target="_blank">linux 下的配置管理命令</a><p><a href="/news/show/50.html" target="_blank">logical查看 system.out.print</a><p><a href="/news/show/49.html" target="_blank">android实现监听短信的代码</a><p><a href="/news/show/48.html" target="_blank">shell 并行执行脚本</a><p><a href="/news/show/47.html" target="_blank">vim 编辑 替换</a><p><a href="/news/show/46.html" target="_blank">windows7 x86自动安装应答文件</a><p><a href="/news/show/45.html" target="_blank">win7 64位自动装机应答文件Autounatte...</a><p><a href="/news/show/44.html" target="_blank">win7 文件共享</a><p> 
		</ul>

				</div>
				<div class="contact_img"><a href="contact.html"><img src="/Yourphp/Tpl/Home/Default/Public/images/contact_img.jpg"></a></div>
			</div>
 
</div>
</div>
<div class="c"></div>
<br>

</div></div>

<div class="footer">
	<div class="main">
        <div class="footer_k1" style="color:#fff;">Copyleft ,复制请说明出处 </div>
    </div>
</div>

<script>showon('.catlist ul li.folder','span.fd_ico','35');</script>
</body>
</html>